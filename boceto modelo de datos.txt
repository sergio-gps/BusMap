Table tipos_vehiculo {
  tipo_id int [pk, increment]
  nombre varchar [not null, unique] 
}

Table lineas {
  linea_id int [pk]
  nombre varchar [not null]
  origen varchar
  destino varchar
  color varchar
}

Table paradas {
  parada_id int [pk]
  nombre_parada varchar [not null]
  latitud double [not null]
  longitud double [not null]
}

// --- VEHÃCULOS Y ASIGNACIONES ---

Table vehiculos {
  vehiculo_id int [pk, increment]
  tipo_id int [ref: > tipos_vehiculo.tipo_id]
}

Table vehiculos_info {
  vehiculo_id int [pk, ref: - vehiculos.vehiculo_id] // RelaciÃ³n 1 a 1
  matricula varchar [not null]
  marca_modelo varchar
  capacidad int
  activo bool [not null]
}

// --- Tablas Intermedias ---

Table parada_linea {
  parada_id int [ref: > paradas.parada_id]
  linea_id int [ref: > lineas.linea_id]

  indexes {
    (parada_id, linea_id) [pk]
  }
}

Table buses_linea {
  vehiculo_id int [ref: > vehiculos.vehiculo_id]
  linea_id int [ref: > lineas.linea_id]
  
  indexes {
    (vehiculo_id, linea_id) [pk]
  }
}

// --- TIEMPO REAL ---

Table localizaciones {
  localizacion_id int [pk, increment]
  vehiculo_id int [ref: > vehiculos.vehiculo_id]
  latitud double [not null]
  longitud double [not null]
  actualizado datetime [not null]
}

Table historico_rutas {
  ruta_id int [pk, increment]
  vehiculo_id int [ref: > vehiculos.vehiculo_id]
  origen_lat double [not null]
  origen_lon double [not null]
  destino_buscado varchar [not null]
  fecha_ruta datetime [not null]
}

// --- USUARIOS, ROLES Y SEGURIDAD ---

Table usuarios {
  usuario_id int [pk, increment]
  username varchar [not null, unique]
}

Table seguridad {
  usuario_id int [pk, ref: - usuarios.usuario_id] // 1 a 1 con Usuarios
  password varchar [not null]
}

Table roles {
  rol_id int [pk, increment]
  rol_name varchar [not null, unique]
}

Table permisos {
  permiso_id int [pk, increment]
  permiso_name varchar [not null, unique]
}

Table usuarios_roles {
  usuario_id int [ref: > usuarios.usuario_id]
  rol_id int [ref: > roles.rol_id]

  indexes {
    (usuario_id, rol_id) [pk]
  }
}

Table roles_permisos {
  rol_id int [ref: > roles.rol_id]
  permiso_id int [ref: > permisos.permiso_id]

  indexes {
    (rol_id, permiso_id) [pk]
  }
}
